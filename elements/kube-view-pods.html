<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="kube-pod.html">

<polymer-element name="kube-view-pods" attributes="data core">
  <template>
    <template repeat="{{item in data.items}}">
      <kube-pod pid="{{item.id}}" data="{{item}}" core="{{core}}"></kube-pod>
    </template>
  </template>
  <script>
    Polymer({
      data: null,
      observe: {
        'core': 'refresh'
      },

      ready: function() {
        if (!this.data)
          this.refresh();
      },

      refresh: function() {
        this.refreshJob = this.job(this.refreshJob, function(){
          this.core && this.core.listPods({callback: this.receive.bind(this)});
        }, 0);
      },

      // TODO: handle errors
      receive: function(response, isError) {
        this.data = response;
      },
    });
  </script>
</polymer-element>
